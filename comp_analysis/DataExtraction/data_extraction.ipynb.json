{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "630b263e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#!pip3 install pandas"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5e4e86d7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#!pip3 install Ipython"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5e589835",
   "metadata": {},
   "outputs": [],
   "source": [
    "import requests as r\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import csv\n",
    "import json\n",
    "from itertools import product"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6c112992",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Using the yelp business search API: https://www.yelp.com/developers/documentation/v3/business_search\n",
    "#please follow instructions in steps.pdf to generate api_key\n",
    "# headers contain the api key.\n",
    "headers = {'Authorization': 'Bearer {}'.format(api_key)}\n",
    "search_api_url = 'https://api.yelp.com/v3/businesses/search'\n",
    "params = {\n",
    "    'term': 'restuarent',\n",
    "    'location': 'Vancouver, British Columbia',\n",
    "    'limit': 50\n",
    "}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "933b0445",
   "metadata": {},
   "outputs": [],
   "source": [
    "response = r.get(search_api_url, headers=headers, params=params, timeout=5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0d86ef6f",
   "metadata": {},
   "outputs": [],
   "source": [
    "print(response.url)\n",
    "print(response.status_code)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0ae37628",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_dict3 = response.json()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e01f268d",
   "metadata": {},
   "outputs": [],
   "source": [
    "cols = [\n",
    "    'id', 'alias', 'name', 'image_url', 'is_closed', 'url', 'review_count',\n",
    "    'categories', 'rating', 'coordinates', 'transactions', 'price', 'location',\n",
    "    'phone', 'display_phone', 'distance'\n",
    "]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bdecf841",
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "data_dict3"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "736a3075",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_dict4 = response.json()\n",
    "data_dict4"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e5773767",
   "metadata": {},
   "outputs": [],
   "source": [
    "with open('data51bc.json', 'w') as fp:\n",
    "    json.dump(data_dict4, fp)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "54dba9f4",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_dict4"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8e82a9cb",
   "metadata": {},
   "outputs": [],
   "source": [
    "with open('data51bc.json', 'w') as fp:\n",
    "    json.dump(data_dict4, fp)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e0e501d1",
   "metadata": {},
   "outputs": [],
   "source": [
    "print(response.url)\n",
    "print(response.status_code)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a2f3cb10",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Using the yelp business search API: https://www.yelp.com/developers/documentation/v3/business_search\n",
    "\n",
    "# headers contain the api key.\n",
    "headers = {'Authorization': 'Bearer {}'.format(api_key)}\n",
    "search_api_url = 'https://api.yelp.com/v3/businesses/search'\n",
    "params = {\n",
    "    'term': 'restuarent',\n",
    "    'location': 'Vancouver, British Columbia',\n",
    "    'limit': 50,\n",
    "    'offset': 701\n",
    "}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8dfc7561",
   "metadata": {},
   "outputs": [],
   "source": [
    "response = r.get(search_api_url, headers=headers, params=params, timeout=5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cf37ec06",
   "metadata": {},
   "outputs": [],
   "source": [
    "print(response.url)\n",
    "print(response.status_code)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f966f857",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_dict18 = response.json()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "42eec6bb",
   "metadata": {},
   "outputs": [],
   "source": [
    "with open('data701bc.json', 'w') as fp:\n",
    "    json.dump(data_dict18, fp)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "88442f91",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Using the yelp business search API: https://www.yelp.com/developers/documentation/v3/business_search\n",
    "\n",
    "# headers contain the api key.\n",
    "headers = {'Authorization': 'Bearer {}'.format(api_key)}\n",
    "search_api_url = 'https://api.yelp.com/v3/businesses/search'\n",
    "params = {\n",
    "    'term': 'restuarent',\n",
    "    'location': 'Vancouver, British Columbia',\n",
    "    'limit': 50,\n",
    "    'offset': 701\n",
    "}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f3404d2b",
   "metadata": {},
   "outputs": [],
   "source": [
    "response = r.get(search_api_url, headers=headers, params=params, timeout=5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f90ed0b6",
   "metadata": {},
   "outputs": [],
   "source": [
    "print(response.url)\n",
    "print(response.status_code)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ec199728",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_dict18 = response.json()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fd88c104",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_dict18"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "709b83db",
   "metadata": {},
   "outputs": [],
   "source": [
    "with open('data701bc.json', 'w') as fp:\n",
    "    json.dump(data_dict18, fp)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b7399f07",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Using the yelp business search API: https://www.yelp.com/developers/documentation/v3/business_search\n",
    "\n",
    "# headers contain the api key.\n",
    "headers = {'Authorization': 'Bearer {}'.format(api_key)}\n",
    "search_api_url = 'https://api.yelp.com/v3/businesses/search'\n",
    "params = {\n",
    "    'term': 'restuarent',\n",
    "    'location': 'Vancouver, British Columbia',\n",
    "    'limit': 50,\n",
    "    'offset': 751\n",
    "}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0050c20a",
   "metadata": {},
   "outputs": [],
   "source": [
    "response = r.get(search_api_url, headers=headers, params=params, timeout=5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "deceb971",
   "metadata": {},
   "outputs": [],
   "source": [
    "print(response.url)\n",
    "print(response.status_code)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5bb16790",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_dict19 = response.json()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "692f35fd",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_dict19"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9c8aafa7",
   "metadata": {},
   "outputs": [],
   "source": [
    "with open('data751bc.json', 'w') as fp:\n",
    "    json.dump(data_dict19, fp)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9fe9b7ae",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Using the yelp business search API: https://www.yelp.com/developers/documentation/v3/business_search\n",
    "\n",
    "# headers contain the api key.\n",
    "headers = {'Authorization': 'Bearer {}'.format(api_key)}\n",
    "search_api_url = 'https://api.yelp.com/v3/businesses/search'\n",
    "params = {\n",
    "    'term': 'restuarent',\n",
    "    'location': 'Vancouver, British Columbia',\n",
    "    'limit': 50,\n",
    "    'offset': 801\n",
    "}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6891328d",
   "metadata": {},
   "outputs": [],
   "source": [
    "response = r.get(search_api_url, headers=headers, params=params, timeout=5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a2913d35",
   "metadata": {},
   "outputs": [],
   "source": [
    "print(response.url)\n",
    "print(response.status_code)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "550db8c0",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_dict21 = response.json()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "32cb9d93",
   "metadata": {},
   "outputs": [],
   "source": [
    "with open('data801bc.json', 'w') as fp:\n",
    "    json.dump(data_dict19, fp)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eb94ef1e",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Using the yelp business search API: https://www.yelp.com/developers/documentation/v3/business_search\n",
    "\n",
    "# headers contain the api key.\n",
    "headers = {'Authorization': 'Bearer {}'.format(api_key)}\n",
    "search_api_url = 'https://api.yelp.com/v3/businesses/search'\n",
    "params = {\n",
    "    'term': 'restuarent',\n",
    "    'location': 'Vancouver, British Columbia',\n",
    "    'limit': 50,\n",
    "    'offset': 851\n",
    "}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4aef557d",
   "metadata": {},
   "outputs": [],
   "source": [
    "response = r.get(search_api_url, headers=headers, params=params, timeout=5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "84074e14",
   "metadata": {},
   "outputs": [],
   "source": [
    "print(response.url)\n",
    "print(response.status_code)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "15a1a060",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_dict22 = response.json()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e0640d90",
   "metadata": {},
   "outputs": [],
   "source": [
    "with open('data851bc.json', 'w') as fp:\n",
    "    json.dump(data_dict22, fp)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ff7266bd",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Using the yelp business search API: https://www.yelp.com/developers/documentation/v3/business_search\n",
    "\n",
    "# headers contain the api key.\n",
    "headers = {'Authorization': 'Bearer {}'.format(api_key)}\n",
    "search_api_url = 'https://api.yelp.com/v3/businesses/search'\n",
    "params = {\n",
    "    'term': 'restuarent',\n",
    "    'location': 'Vancouver, British Columbia',\n",
    "    'limit': 50,\n",
    "    'offset': 901\n",
    "}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a2a60575",
   "metadata": {},
   "outputs": [],
   "source": [
    "response = r.get(search_api_url, headers=headers, params=params, timeout=5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6c34e611",
   "metadata": {},
   "outputs": [],
   "source": [
    "print(response.url)\n",
    "print(response.status_code)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "76d23d92",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_dict23 = response.json()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "03df5958",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_dict23"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "21de2acf",
   "metadata": {},
   "outputs": [],
   "source": [
    "with open('data851bc.json', 'w') as fp:\n",
    "    json.dump(data_dict23, fp)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "50ac4526",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Using the yelp business search API: https://www.yelp.com/developers/documentation/v3/business_search\n",
    "\n",
    "# headers contain the api key.\n",
    "headers = {'Authorization': 'Bearer {}'.format(api_key)}\n",
    "search_api_url = 'https://api.yelp.com/v3/businesses/search'\n",
    "params = {\n",
    "    'term': 'restuarent',\n",
    "    'location': 'Vancouver, British Columbia',\n",
    "    'limit': 50,\n",
    "    'offset': 951\n",
    "}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a22f5691",
   "metadata": {},
   "outputs": [],
   "source": [
    "response = r.get(search_api_url, headers=headers, params=params, timeout=5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d5999d1c",
   "metadata": {},
   "outputs": [],
   "source": [
    "print(response.url)\n",
    "print(response.status_code)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5f157448",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_dict24 = response.json()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f952a0a2",
   "metadata": {},
   "outputs": [],
   "source": [
    "with open('data901bc.json', 'w') as fp:\n",
    "    json.dump(data_dict24, fp)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "143462e6",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "58de7ec0",
   "metadata": {},
   "outputs": [],
   "source": [
    "df1 = pd.read_csv(\"combined.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f703de66",
   "metadata": {},
   "outputs": [],
   "source": [
    "len(df1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "453a6dd7",
   "metadata": {},
   "outputs": [],
   "source": [
    "df1.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b31e8103",
   "metadata": {},
   "outputs": [],
   "source": [
    "df1.rename(\n",
    "    columns={\n",
    "        \"categories/0/alias\": \"category_alias\",\n",
    "        \"categories/0/title\": \"Category_2: Title\"\n",
    "    })"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1513cbe9",
   "metadata": {},
   "outputs": [],
   "source": [
    "df1.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3ef7190c",
   "metadata": {},
   "outputs": [],
   "source": [
    "df1.to_csv('outcombined.csv', sep='\\t', encoding='utf-8')"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
